<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Weavr Docs - Workflow Reference</title>
    <meta name="description" content="YAML workflow syntax, triggers, actions, and variable interpolation." />
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg-grid"></div>
    <div class="bg-glow"></div>

    <header class="site-header">
      <div class="container header-inner">
        <a class="brand" href="index.html">
          <img src="assets/openweavr-logo-text.png" alt="Weavr" />
        </a>
        <button class="nav-toggle" data-nav-toggle>Menu</button>
        <nav class="site-nav" data-site-nav>
          <a href="overview.html">Overview</a>
          <a href="getting-started.html">Getting Started</a>
          <a href="cli.html">CLI</a>
          <a href="web-app.html">Web App</a>
          <a href="workflows.html" aria-current="page">Workflows</a>
          <a href="integrations.html">Integrations</a>
          <a href="agents.html">AI Agents</a>
          <a href="troubleshooting.html">Troubleshooting</a>
        </nav>
      </div>
    </header>

    <main class="container page">
      <aside class="sidebar">
        <h3>Workflow Reference</h3>
        <a class="active" href="#structure">Structure</a>
        <a href="#triggers">Triggers</a>
        <a href="#steps">Steps</a>
        <a href="#actions">Built-in Actions</a>
        <a href="#dependencies">Dependencies</a>
        <a href="#interpolation">Interpolation</a>
        <a href="#conditionals">Conditionals</a>
      </aside>

      <section class="content">
        <div class="section" id="structure">
          <h2>Workflow Structure</h2>
          <p>Workflows are defined in YAML files with the following structure:</p>

          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code><span class="keyword">name:</span> <span class="string">workflow-name</span>
<span class="keyword">description:</span> <span class="string">What this workflow does</span>

<span class="comment"># Optional: Trigger that starts the workflow</span>
<span class="keyword">trigger:</span>
  <span class="keyword">type:</span> <span class="string">trigger.type</span>
  <span class="keyword">with:</span>
    <span class="keyword">key:</span> <span class="string">value</span>

<span class="comment"># Required: Steps to execute</span>
<span class="keyword">steps:</span>
  - <span class="keyword">id:</span> <span class="string">step-id</span>
    <span class="keyword">action:</span> <span class="string">action.name</span>
    <span class="keyword">with:</span>
      <span class="keyword">key:</span> <span class="string">value</span></code></pre>
          </div>

          <h3>Fields</h3>
          <table class="table">
            <thead>
              <tr>
                <th>Field</th>
                <th>Required</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="inline-code">name</span></td>
                <td>Yes</td>
                <td>Unique identifier for the workflow</td>
              </tr>
              <tr>
                <td><span class="inline-code">description</span></td>
                <td>No</td>
                <td>Human-readable description</td>
              </tr>
              <tr>
                <td><span class="inline-code">trigger</span></td>
                <td>No</td>
                <td>Event that starts the workflow automatically</td>
              </tr>
              <tr>
                <td><span class="inline-code">steps</span></td>
                <td>Yes</td>
                <td>Array of steps to execute</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="section" id="triggers">
          <h2>Triggers</h2>
          <p>Triggers define events that automatically start a workflow.</p>

          <h3>Available Triggers</h3>
          <table class="table">
            <thead>
              <tr>
                <th>Trigger</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="inline-code">cron.schedule</span></td>
                <td>Run on a schedule (cron expression)</td>
              </tr>
              <tr>
                <td><span class="inline-code">http.webhook</span></td>
                <td>Run when a webhook is received</td>
              </tr>
              <tr>
                <td><span class="inline-code">github.push</span></td>
                <td>Run on GitHub push events</td>
              </tr>
              <tr>
                <td><span class="inline-code">github.pull_request</span></td>
                <td>Run on GitHub PR events</td>
              </tr>
              <tr>
                <td><span class="inline-code">github.issue.opened</span></td>
                <td>Run when a GitHub issue is opened</td>
              </tr>
              <tr>
                <td><span class="inline-code">telegram.message</span></td>
                <td>Run on incoming Telegram messages</td>
              </tr>
            </tbody>
          </table>

          <p>See <a href="integrations.html">Integrations</a> for detailed trigger configuration.</p>
        </div>

        <div class="section" id="steps">
          <h2>Steps</h2>
          <p>Steps are the individual units of work in a workflow.</p>

          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code><span class="keyword">steps:</span>
  - <span class="keyword">id:</span> <span class="string">unique-step-id</span>       <span class="comment"># Required: Unique identifier</span>
    <span class="keyword">action:</span> <span class="string">plugin.action</span>    <span class="comment"># Required: Action to execute</span>
    <span class="keyword">needs:</span> <span class="string">[other-step-id]</span>   <span class="comment"># Optional: Dependencies</span>
    <span class="keyword">if:</span> <span class="string">"{{ condition }}"</span>    <span class="comment"># Optional: Conditional execution</span>
    <span class="keyword">with:</span>                    <span class="comment"># Optional: Action parameters</span>
      <span class="keyword">key:</span> <span class="string">value</span>
    <span class="keyword">retry:</span>                   <span class="comment"># Optional: Retry configuration</span>
      <span class="keyword">attempts:</span> <span class="number">3</span>
      <span class="keyword">delay:</span> <span class="number">1000</span></code></pre>
          </div>

          <h3>Step Fields</h3>
          <table class="table">
            <thead>
              <tr>
                <th>Field</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="inline-code">id</span></td>
                <td>Unique identifier for referencing in other steps</td>
              </tr>
              <tr>
                <td><span class="inline-code">action</span></td>
                <td>The action to execute (plugin.action format)</td>
              </tr>
              <tr>
                <td><span class="inline-code">needs</span></td>
                <td>Array of step IDs that must complete first</td>
              </tr>
              <tr>
                <td><span class="inline-code">if</span></td>
                <td>Condition that must be true to run this step</td>
              </tr>
              <tr>
                <td><span class="inline-code">with</span></td>
                <td>Parameters passed to the action</td>
              </tr>
              <tr>
                <td><span class="inline-code">retry</span></td>
                <td>Retry configuration for failed steps</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="section" id="actions">
          <h2>Built-in Actions</h2>

          <h3>transform</h3>
          <p>Create a value from a template string.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code>- <span class="keyword">id:</span> <span class="string">message</span>
  <span class="keyword">action:</span> <span class="string">transform</span>
  <span class="keyword">with:</span>
    <span class="keyword">template:</span> <span class="string">"Hello, {{ input.name }}!"</span></code></pre>
          </div>

          <h3>log</h3>
          <p>Log a message to the workflow output.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code>- <span class="keyword">id:</span> <span class="string">log-result</span>
  <span class="keyword">action:</span> <span class="string">log</span>
  <span class="keyword">with:</span>
    <span class="keyword">message:</span> <span class="string">"Processing complete: {{ steps.process.result }}"</span></code></pre>
          </div>

          <h3>http.request</h3>
          <p>Make an HTTP request.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code>- <span class="keyword">id:</span> <span class="string">fetch-data</span>
  <span class="keyword">action:</span> <span class="string">http.request</span>
  <span class="keyword">with:</span>
    <span class="keyword">url:</span> <span class="string">"https://api.example.com/data"</span>
    <span class="keyword">method:</span> <span class="string">GET</span>
    <span class="keyword">headers:</span>
      <span class="keyword">Authorization:</span> <span class="string">"Bearer {{ env.API_TOKEN }}"</span></code></pre>
          </div>

          <h3>ai.agent</h3>
          <p>Execute an AI agent task. See <a href="agents.html">AI Agents</a> for details.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code>- <span class="keyword">id:</span> <span class="string">analyze</span>
  <span class="keyword">action:</span> <span class="string">ai.agent</span>
  <span class="keyword">with:</span>
    <span class="keyword">task:</span> <span class="string">"Analyze this data and provide insights"</span></code></pre>
          </div>

          <h3>json.parse</h3>
          <p>Parse a JSON string into an object.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code>- <span class="keyword">id:</span> <span class="string">parse-response</span>
  <span class="keyword">action:</span> <span class="string">json.parse</span>
  <span class="keyword">with:</span>
    <span class="keyword">input:</span> <span class="string">"{{ steps.fetch.body }}"</span></code></pre>
          </div>

          <h3>json.stringify</h3>
          <p>Convert an object to a JSON string.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code>- <span class="keyword">id:</span> <span class="string">serialize</span>
  <span class="keyword">action:</span> <span class="string">json.stringify</span>
  <span class="keyword">with:</span>
    <span class="keyword">input:</span> <span class="string">"{{ steps.data }}"</span>
    <span class="keyword">pretty:</span> <span class="keyword">true</span></code></pre>
          </div>
        </div>

        <div class="section" id="dependencies">
          <h2>Dependencies</h2>
          <p>Use <span class="inline-code">needs</span> to control step execution order.</p>

          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code><span class="keyword">steps:</span>
  - <span class="keyword">id:</span> <span class="string">fetch</span>
    <span class="keyword">action:</span> <span class="string">http.request</span>
    <span class="keyword">with:</span>
      <span class="keyword">url:</span> <span class="string">"https://api.example.com/data"</span>

  - <span class="keyword">id:</span> <span class="string">parse</span>
    <span class="keyword">action:</span> <span class="string">json.parse</span>
    <span class="keyword">needs:</span> <span class="string">[fetch]</span>              <span class="comment"># Runs after 'fetch' completes</span>
    <span class="keyword">with:</span>
      <span class="keyword">input:</span> <span class="string">"{{ steps.fetch.body }}"</span>

  - <span class="keyword">id:</span> <span class="string">process</span>
    <span class="keyword">action:</span> <span class="string">ai.agent</span>
    <span class="keyword">needs:</span> <span class="string">[parse]</span>              <span class="comment"># Runs after 'parse' completes</span>
    <span class="keyword">with:</span>
      <span class="keyword">task:</span> <span class="string">"Analyze: {{ steps.parse }}"</span>

  - <span class="keyword">id:</span> <span class="string">notify</span>
    <span class="keyword">action:</span> <span class="string">slack.post</span>
    <span class="keyword">needs:</span> <span class="string">[process]</span>            <span class="comment"># Runs after 'process' completes</span>
    <span class="keyword">with:</span>
      <span class="keyword">channel:</span> <span class="string">"#results"</span>
      <span class="keyword">text:</span> <span class="string">"{{ steps.process.response }}"</span></code></pre>
          </div>

          <h3>Parallel Execution</h3>
          <p>Steps without dependencies or with the same dependencies run in parallel.</p>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code><span class="keyword">steps:</span>
  - <span class="keyword">id:</span> <span class="string">fetch-users</span>
    <span class="keyword">action:</span> <span class="string">http.request</span>
    <span class="keyword">with:</span>
      <span class="keyword">url:</span> <span class="string">"/api/users"</span>

  - <span class="keyword">id:</span> <span class="string">fetch-orders</span>
    <span class="keyword">action:</span> <span class="string">http.request</span>
    <span class="keyword">with:</span>
      <span class="keyword">url:</span> <span class="string">"/api/orders"</span>

  <span class="comment"># Both fetch steps run in parallel</span>
  <span class="comment"># This step waits for both</span>
  - <span class="keyword">id:</span> <span class="string">combine</span>
    <span class="keyword">action:</span> <span class="string">transform</span>
    <span class="keyword">needs:</span> <span class="string">[fetch-users, fetch-orders]</span>
    <span class="keyword">with:</span>
      <span class="keyword">template:</span> <span class="string">"Users: {{ steps.fetch-users.body }}, Orders: {{ steps.fetch-orders.body }}"</span></code></pre>
          </div>
        </div>

        <div class="section" id="interpolation">
          <h2>Variable Interpolation</h2>
          <p>Use <span class="inline-code">{{ }}</span> syntax to reference dynamic values.</p>

          <h3>Available Variables</h3>
          <table class="table">
            <thead>
              <tr>
                <th>Variable</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="inline-code">{{ trigger.* }}</span></td>
                <td>Data from the trigger event</td>
              </tr>
              <tr>
                <td><span class="inline-code">{{ steps.stepId }}</span></td>
                <td>Output from a previous step</td>
              </tr>
              <tr>
                <td><span class="inline-code">{{ steps.stepId.field }}</span></td>
                <td>Specific field from step output</td>
              </tr>
              <tr>
                <td><span class="inline-code">{{ input.* }}</span></td>
                <td>Input data passed to the workflow</td>
              </tr>
              <tr>
                <td><span class="inline-code">{{ env.VAR_NAME }}</span></td>
                <td>Environment variable</td>
              </tr>
              <tr>
                <td><span class="inline-code">{{ currentISODate }}</span></td>
                <td>Current timestamp in ISO format</td>
              </tr>
            </tbody>
          </table>

          <h3>Examples</h3>
          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code><span class="comment"># Access trigger data</span>
<span class="keyword">message:</span> <span class="string">"New PR: {{ trigger.pullRequest.title }}"</span>

<span class="comment"># Access step output</span>
<span class="keyword">body:</span> <span class="string">"{{ steps.analyze.response }}"</span>

<span class="comment"># Access nested fields</span>
<span class="keyword">author:</span> <span class="string">"{{ trigger.issue.user.login }}"</span>

<span class="comment"># Environment variables</span>
<span class="keyword">token:</span> <span class="string">"{{ env.GITHUB_TOKEN }}"</span>

<span class="comment"># Combine values</span>
<span class="keyword">url:</span> <span class="string">"https://api.example.com/{{ trigger.repo }}/issues/{{ trigger.number }}"</span></code></pre>
          </div>
        </div>

        <div class="section" id="conditionals">
          <h2>Conditional Execution</h2>
          <p>Use <span class="inline-code">if</span> to conditionally execute steps.</p>

          <div class="code-block">
            <div class="code-header">
              <div class="code-dot red"></div>
              <div class="code-dot yellow"></div>
              <div class="code-dot green"></div>
            </div>
            <pre><code><span class="keyword">steps:</span>
  - <span class="keyword">id:</span> <span class="string">check-label</span>
    <span class="keyword">action:</span> <span class="string">transform</span>
    <span class="keyword">with:</span>
      <span class="keyword">template:</span> <span class="string">"{{ trigger.action }}"</span>

  <span class="comment"># Only run if PR was opened</span>
  - <span class="keyword">id:</span> <span class="string">review</span>
    <span class="keyword">action:</span> <span class="string">ai.agent</span>
    <span class="keyword">if:</span> <span class="string">"{{ trigger.action == 'opened' }}"</span>
    <span class="keyword">with:</span>
      <span class="keyword">task:</span> <span class="string">"Review this PR"</span>

  <span class="comment"># Only run if labeled with 'urgent'</span>
  - <span class="keyword">id:</span> <span class="string">alert</span>
    <span class="keyword">action:</span> <span class="string">slack.post</span>
    <span class="keyword">if:</span> <span class="string">"{{ 'urgent' in trigger.issue.labels }}"</span>
    <span class="keyword">with:</span>
      <span class="keyword">channel:</span> <span class="string">"#urgent"</span>
      <span class="keyword">text:</span> <span class="string">"Urgent issue: {{ trigger.issue.title }}"</span></code></pre>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="container">
        <a href="https://github.com/openweavr/Openweavr" target="_blank">GitHub</a>
        &nbsp;&middot;&nbsp;
        MIT License
      </div>
    </footer>

    <script src="script.js"></script>
  </body>
</html>
